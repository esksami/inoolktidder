{% extends "layout.html" %}

{% block body %}
<div class="bg-white mx-auto p-4 border rounded" style="min-width: 320px; max-width: 450px">
  <h1 class="mb-4">Profile</h1>
  <div id="username-container" class="d-flex flex-column">
    <div class="d-flex flex-row border-bottom">
      <div class="visible h4 mb-0 text-info font-weight-bold">
        {{user.username}}
      </div>
      <button class="invisible p-0 mb-auto" onclick="show_edit_username_box()">
        <div class="d-flex flex-row btn p-0 color-hover text-secondary visible">
          <div class="material-icons md-18 visible">edit</div>
          <div class="visible pb-1 pl-1 small-text-l font-weight-bold">Edit</div>
        </div>
      </button>
    </div>
    <div id="username-form" class="bg-white" style="min-width: 320px; max-width: 420px; display: none;">
      <form class="form-signin" method="POST" action="{{ url_for('user_edit_username') }}">
        <div class="my-2">
          {{ usernameForm.username.label(class_="sr-only") }}
          {{ usernameForm.username(class_="form-control", placeholder="New username", autofocus="", required="") }}
        </div>

        <button class="btn btn-lg btn-primary btn-block w-20 small-text-l font-weight-bold p-1" type="submit">Confirm</button>
      </form>
    </div>
  {% if usernameForm.username.errors %}
    <div class="text-info">
      <ul>
        {% for error in usernameForm.username.errors %}
        <li>{{ error }}</li>
        {% endfor %}
      </ul>
    </div>
  {% endif %}
  </div>
{% if errors %}
  <div class="text-info">
    <ul>
      {% for error in errors %}
      <li>{{ error }}</li>
      {% endfor %}
    </ul>
  </div>
{% endif %}
<div id="password-form" class="bg-white mt-3" style="min-width: 320px; max-width: 420px">
  <h3>Set new password</h3>
  <form class="form-signin" method="POST" action="{{ url_for('user_edit_password') }}">
    <div class="my-2">
      {{ passwordForm.password.label(class_="sr-only") }}
      {{ passwordForm.password(class_="form-control", placeholder="Password", required="") }}
    </div>
  {% if passwordForm.password.errors %}
    <div class="text-info">
      <ul>
        {% for error in passwordForm.password.errors %}
        <li>{{ error }}</li>
        {% endfor %}
      </ul>
    </div>
  {% endif %}
    <div class="my-2">
      {{ passwordForm.confirmPassword.label(class_="sr-only") }}
      {{ passwordForm.confirmPassword(class_="form-control", placeholder="Repeat password", required="") }}
    </div>
  {% if passwordForm.confirmPassword.errors %}
    <div class="text-info">
      <ul>
        {% for error in passwordForm.confirmPassword.errors %}
        <li>{{ error }}</li>
        {% endfor %}
      </ul>
    </div>
  {% endif %}
    <button class="btn btn-lg btn-primary btn-block w-20 small-text-l font-weight-bold p-1" type="submit">Confirm</button>
  </form>
</div>
</div>
<script type="text/javascript">
  const show_edit_username_box = () => {
    var usernameEditForm = document.getElementById('username-form')
    
    display = usernameEditForm.style.display

    if (display === 'none') {
      usernameEditForm.style.display = "";
    } else {
      usernameEditForm.style.display = "none";
    }
  };
</script>
{% endblock %}